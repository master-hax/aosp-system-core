{
  "comments": [
    {
      "key": {
        "uuid": "670f0897_ca6177e5",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2019-09-13T15:30:59Z",
      "side": 1,
      "message": "Do we actually have confirmation that the logs go to logd?  I thought they were going to stderr, so without a wrapper, they\u0027re going to be dropped.\n\nThis trigger isn\u0027t quite right either.  It is saying that \"when init happens, check that abilist32 is set and logd is running\", but logd doesn\u0027t start until the below init trigger (and these are all run in the order that they appear in this file), so it\u0027s guaranteed to never run.",
      "range": {
        "startLine": 77,
        "startChar": 50,
        "endLine": 77,
        "endChar": 80
      },
      "revId": "8d8fcf622aa7462ef674d1acbaf082f528470511",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "871cb15e_377a1e8c",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1103203
      },
      "writtenOn": "2019-09-13T16:21:50Z",
      "side": 1,
      "message": "Ah, I didn\u0027t know that these were order-dependent.\n\nAnyway, it sounds like consensus is that a better approach would be to redirect logs to kernel log until logd is ready (I don\u0027t know how to), so I\u0027ll just abandon this CL.",
      "parentUuid": "670f0897_ca6177e5",
      "range": {
        "startLine": 77,
        "startChar": 50,
        "endLine": 77,
        "endChar": 80
      },
      "revId": "8d8fcf622aa7462ef674d1acbaf082f528470511",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fc40aec8_85455cee",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2019-09-13T18:01:26Z",
      "side": 1,
      "message": "Tom: the linker debug I mentioned earlier only goes to logd, yes:\n\n$ adb shell echo hello\nhello\n$ adb logcat\n/.../\n09-13 18:31:21.866 22745 22745 W linker  : [ Android dynamic linker (64-bit) ]\n09-13 18:31:21.867 22745 22745 W linker  : [ Linking executable \"/system/bin/sh\" ]\n09-13 18:31:21.867 22745 22745 W linker  : [ Linking \"[vdso]\" ]\n09-13 18:31:21.867 22745 22745 W linker  : [ Reading linker config \"/system/etc/ld.config.R.txt\" ]\n09-13 18:31:21.868 22745 22745 W linker  : [ Using config section \"system\" ]\n09-13 18:31:21.876 22745 22745 W linker  : [ Linking \"/system/bin/sh\" ]\n09-13 18:31:21.876 22745 22745 D linker  : find_libraries(ns\u003d(default)): task\u003dlibclang_rt.hwasan-aarch64-android.so, is_dt_needed\u003d1\n/.../\n\nAs mentioned, the final \"CANNOT LINK\" error itself goes to both, and hopefully most fatal errors would go to stderr. So I think using logwrapper here is a good idea, although it doesn\u0027t replace falling back to the kernel log for pre-logd logcat messages. I\u0027ll put a CL together next week.",
      "parentUuid": "871cb15e_377a1e8c",
      "range": {
        "startLine": 77,
        "startChar": 50,
        "endLine": 77,
        "endChar": 80
      },
      "revId": "8d8fcf622aa7462ef674d1acbaf082f528470511",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9fe9f531_47b38ec8",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2019-09-13T18:15:58Z",
      "side": 1,
      "message": "I was wondering more the actual logs from boringssl_self_test.  Or do we not figure that the actual test won\u0027t ever fail?  Which, in fairness, is probably a good assumption, no?",
      "parentUuid": "fc40aec8_85455cee",
      "range": {
        "startLine": 77,
        "startChar": 50,
        "endLine": 77,
        "endChar": 80
      },
      "revId": "8d8fcf622aa7462ef674d1acbaf082f528470511",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cd72ad0d_eb80729e",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2019-09-13T19:20:41Z",
      "side": 1,
      "message": "Right, my point was just that the extra trace I often need doesn\u0027t go to stderr.\n\n\u003e Or do we not figure that the actual test won\u0027t ever fail?\n\nMany negations there, but yeah, of course it will. I\u0027ll put the logwrapper in.",
      "parentUuid": "9fe9f531_47b38ec8",
      "range": {
        "startLine": 77,
        "startChar": 50,
        "endLine": 77,
        "endChar": 80
      },
      "revId": "8d8fcf622aa7462ef674d1acbaf082f528470511",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df591dfe_adef4fc9",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2019-09-23T18:33:05Z",
      "side": 1,
      "message": "Turned out that adding the logwrapper is a bit more involved than I hoped, because SELinux (of course): some amount of spells are necessary to allow it to run in the boringssl_self_test domain.\n\nIt also occurred to me that while logwrapper might help capture linker errors for the boringssl_self_test binary, it itself is susceptible to linker errors and other loading issues. Hence it seems better if init could redirect stderr and/or stdout directly.\n\nTom, if you\u0027re working on that I think I\u0027ll just save the time sorting out the SELinux incantations, but otherwise I might dig into it a bit more.",
      "parentUuid": "cd72ad0d_eb80729e",
      "range": {
        "startLine": 77,
        "startChar": 50,
        "endLine": 77,
        "endChar": 80
      },
      "revId": "8d8fcf622aa7462ef674d1acbaf082f528470511",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}