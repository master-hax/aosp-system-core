{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "60df879f_3ef6b62f",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2024-07-30T01:36:22Z",
      "side": 1,
      "message": "How is this threshold determined? Could different platforms configure different sizes for backing device? Is this value going to be good for all OEMs?",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1acfbecc_306b895b",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1894539
      },
      "writtenOn": "2024-07-30T03:25:15Z",
      "side": 1,
      "message": "The threshold is from the local testing on pixel devices (with additional margins)\nBut you are right, different platform may require different threshold.\nHow about adding a system property to let OEMs customize the value?",
      "parentUuid": "60df879f_3ef6b62f",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a5a88f7_60d799f4",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2024-07-30T03:41:30Z",
      "side": 1,
      "message": "system property SGTM",
      "parentUuid": "1acfbecc_306b895b",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d59293fb_ef0961f0",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2024-07-30T16:27:55Z",
      "side": 1,
      "message": "On a closer look, the caller already passes in a size, and the 512MB margin is only served as a head room? What is causing the caller supplied size to be inaccurate?",
      "parentUuid": "8a5a88f7_60d799f4",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8c8facf3_06cd78a4",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1894539
      },
      "writtenOn": "2024-07-31T03:06:50Z",
      "side": 1,
      "message": "The zram backing device will create a file in userdata during booting. When the free space in userdata is low, it has chance to run out the remaining disk size and cause the booting failure.\nThat\u0027s why we want to add the margin size.",
      "parentUuid": "d59293fb_ef0961f0",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dfc578bc_cf362305",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1894539
      },
      "writtenOn": "2024-07-31T09:10:14Z",
      "side": 1,
      "message": "Update the system property version and tested on Pixel devices.\nPlease help review the change. Thanks!",
      "parentUuid": "8c8facf3_06cd78a4",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c6afdfae_1c436565",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2024-07-31T16:34:50Z",
      "side": 1,
      "message": "\u003e When the free space in userdata is low, it has chance to run out the remaining disk size\n\nThat make sense, but isn\u0027t the disk size requirement already captured by `size` parameter? If /data has `size` bytes free then we do expect the allocation to succeed. Filesystems might have some round off errors in size reporting, but the different should not be as huge as 512MB.",
      "parentUuid": "dfc578bc_cf362305",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c0f053d6_6d7071c8",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1894539
      },
      "writtenOn": "2024-08-01T03:35:14Z",
      "side": 1,
      "message": "Before this patch, for example, if `size` is 1024MB and /data has 1025MB free space, then the zram backing device file can be created successfully but /data only left 1MB. It will impact the remaining booting.",
      "parentUuid": "c6afdfae_1c436565",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15fedd45_e15d1c03",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2024-08-01T03:48:59Z",
      "side": 1,
      "message": "Make sense, thanks for the explanation! Can we document this consideration in comment? Mention that zram backing device can be created as long as `/data` has at least `size` free space, though we want to leave some room for remaining boot process.",
      "parentUuid": "c0f053d6_6d7071c8",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4130ff0_ca6143c1",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1894539
      },
      "writtenOn": "2024-08-01T04:24:30Z",
      "side": 1,
      "message": "Sure, I\u0027ve updated the comments. Thanks for the suggestion.",
      "parentUuid": "15fedd45_e15d1c03",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "19b345ca_610a4d22",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2076,
      "author": {
        "id": 1894539
      },
      "writtenOn": "2024-08-01T07:24:40Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e4130ff0_ca6143c1",
      "revId": "173284b1b3a98b7260ad21dd9c914029d357e5e3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}